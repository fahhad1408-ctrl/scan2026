<!DOCTYPE html>
<html>
<head>
    <title>Ø£Ø¯Ø§Ø© ÙØ­Øµ Ø§Ù„Ù…ÙˆÙ‚Ø¹ (GPS + VPN)</title>
    <style>
        /* Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø¹Ø§Ù… ÙˆØ§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ */
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f0f2f5;
            color: #333;
            margin: 0;
            padding: 20px;
            text-align: center;
        }
        .container {
            max-width: 650px;
            margin: 40px auto;
            background-color: #ffffff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
        }
        h2 {
            color: #0056b3;
            margin-bottom: 25px;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
        }

        /* Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ */
        .instruction {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: right;
            line-height: 1.6;
        }
        .instruction strong {
            color: #dc3545;
        }

        /* Ø²Ø± Ø§Ù„ÙØ­Øµ */
        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 18px;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.1s;
            margin-bottom: 30px;
            font-weight: bold;
        }
        button:hover:not(:disabled) {
            background-color: #0056b3;
        }
        button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }

        /* ØµÙ†Ø¯ÙˆÙ‚ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø­Ø§Ù„Ø© */
        #status {
            font-size: 1.6em; /* Ø²ÙŠØ§Ø¯Ø© Ø­Ø¬Ù… Ø§Ù„Ø®Ø· */
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            font-weight: bold;
        }

        /* ÙØ¦Ø§Øª Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ù„Ù„Ù†ØªØ§Ø¦Ø¬ */
        .safe { background-color: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .suspicious { background-color: #fff3cd; color: #856404; border: 1px solid #ffeeba; }
        .critical { background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .info { background-color: #cce5ff; color: #004085; border: 1px solid #b8daff; }

        /* Ù…Ù†Ø·Ù‚Ø© ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙØ­Øµ */
        #details {
            text-align: right;
            border-top: 1px dashed #ccc;
            padding-top: 15px;
            line-height: 1.8;
            font-size: 0.95em;
        }
        #details strong {
            color: #007bff;
            display: inline-block;
            min-width: 200px; /* Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø¹Ø±Ø¶ Ù„Ù„ÙˆØ¶ÙˆØ­ */
        }

        /* Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… */
        .progress-bar-container {
            height: 25px;
            background-color: #e9ecef;
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: 15px;
        }
        .progress-bar {
            height: 100%;
            width: 0%;
            background-color: #28a745;
            transition: width 0.5s ease-in-out;
            text-align: center;
            color: white;
            line-height: 25px;
            font-weight: bold;
        }
    </style>
</head>
<body>

    <div class="container">
        <h2>Ù†Ø¸Ø§Ù… Ø§Ù„ÙØ­Øµ Ø§Ù„Ø£Ù…Ù†ÙŠ Ø§Ù„Ù…ØªÙ‚Ø¯Ù… Ù„Ù„Ù…ÙˆÙ‚Ø¹</h2>

        <div class="instruction">
            <p> Ù„Ø¥ØªÙ…Ø§Ù… Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ø´Ø§Ù…Ù„Ø© (GPS Ùˆ VPN)ØŒ ÙŠØ¬Ø¨ Ø¹Ù„ÙŠÙƒ **Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù…ÙˆÙ‚Ø¹** Ø¹Ù†Ø¯Ù…Ø§ ÙŠØ·Ù„Ø¨ Ù…Ù†Ùƒ Ø§Ù„Ù…ØªØµÙØ­ Ø°Ù„Ùƒ.</p>
            <p><strong>Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ "Ø§Ù„Ø³Ù…Ø§Ø­" ÙÙŠ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© Ø«Ù„Ø§Ø« Ù…Ø±Ø§Øª Ù…ØªØªØ§Ù„ÙŠØ©.</strong></p>
        </div>

        <button id="scanButton" onclick="startMultiCheck()">Ø§Ù„Ø¨Ø¯Ø¡ ÙÙŠ ÙØ­Øµ Ø§Ù„Ø¬ÙˆØ§Ù„</button>
        
        <div class="progress-bar-container">
            <div id="progressBar" class="progress-bar">Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„ÙØ­Øµ</div>
        </div>
        
        <div id="status" class="info">ÙŠØ¬Ø¨ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ù„Ø§ØªØ®Ø§Ø° Ù‚Ø±Ø§Ø¡Ø© Ø¯Ù‚ÙŠÙ‚Ø©.</div>
        
        <div id="details">
            <p><strong>Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª (Ø§Ù„Ù…Ø³ØªØ´Ø¹Ø±Ø§Øª):</strong> --</p>
            <p><strong>Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª (Ø§Ù„Ø´Ø¨ÙƒØ© IP):</strong> --</p>
            <p><strong>Ø§Ù„Ø¯Ù‚Ø© Ø§Ù„Ù…ÙØ¨Ù„Ù‘Øº Ø¹Ù†Ù‡Ø§:</strong> --</p>
            <p><strong>Ù…ØµØ¯Ø± Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…ÙØ³ØªØ¯ÙÙ„:</strong> --</p>
            <p><strong>ØªÙ†Ø§Ù‚Ø¶ IP/GPS:</strong> --</p>
        </div>
    </div>

    <script>
        let lastPosition = null;
        let attemptCount = 0;
        let ipLocation = null; // Ø³ÙŠØ­Ù…Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…Ø³ØªÙ†Ø¯ Ø¥Ù„Ù‰ IP
        
        const MAX_ATTEMPTS = 3;
        const SCAN_INTERVAL_MS = 2000;
        
        // --- Ø«ÙˆØ§Ø¨Øª Ø§Ù„ÙƒØ´Ù ---
        const PERFECT_ACCURACY_THRESHOLD = 5; 
        const FAIL_ACCURACY_THRESHOLD = 50000; 
        const SUSPICIOUS_SPEED_KMH = 400; 
        const VPN_DISCREPANCY_THRESHOLD_KM = 50; // ØªÙ†Ø§Ù‚Ø¶ 50 ÙƒÙ… Ø¨ÙŠÙ† IP Ùˆ GPS ÙŠØ¹ØªØ¨Ø± Ø§Ø´ØªØ¨Ø§Ù‡ VPN

        // Ø¯Ø§Ù„Ø© Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø³Ø§ÙØ©
        function deg2rad(deg) { return deg * (Math.PI / 180); }
        function getDistance(lat1, lon1, lat2, lon2) {
            const R = 6371; 
            const dLat = deg2rad(lat2 - lat1);
            const dLon = deg2rad(lon2 - lon1);
            const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) + Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) * Math.sin(dLon / 2) * Math.sin(dLon / 2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
            return R * c; 
        }

        function inferLocationSource(accuracy) {
            if (accuracy <= 10) {
                return "GPS Ø¹Ø§Ù„ÙŠ Ø§Ù„Ø¯Ù‚Ø© (Ø£Ù‚Ù…Ø§Ø± ØµÙ†Ø§Ø¹ÙŠØ©)";
            } else if (accuracy <= 100) {
                return "Wi-Fi Ø£Ùˆ GPS Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯";
            } else if (accuracy <= 5000) {
                return "Ø´Ø¨ÙƒØ© Ø§Ù„Ø¬ÙˆØ§Ù„ (Cell ID)";
            } else {
                return "ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ / ÙØ´Ù„ ØªØ­Ø¯ÙŠØ¯ Ø¯Ù‚ÙŠÙ‚";
            }
        }

        function updateScreen(message, className, details, progress) {
            document.getElementById('status').innerHTML = message;
            document.getElementById('status').className = 'result ' + className;
            document.getElementById('details').innerHTML = details;
            
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('progressBar').innerHTML = `Ø¬Ø§Ø±ÙŠ Ø§Ù„ÙØ­Øµ... ${progress}%`;
            
            if (progress === 100) {
                document.getElementById('progressBar').innerHTML = "Ø§ÙƒØªÙ…Ù„ Ø§Ù„ÙØ­Øµ";
            }
        }

        function handleError(error) {
            const detailsHTML = `<p><strong>Ø±Ù…Ø² Ø§Ù„Ø®Ø·Ø£:</strong> ${error.code}</p><p><strong>Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø£:</strong> ØªÙ… Ø±ÙØ¶ Ø§Ù„Ø¥Ø°Ù† Ø£Ùˆ Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù…Ù‡Ù„Ø©.</p>`;
            updateScreen("ğŸ”´ ÙØ´Ù„ Ø§Ù„ÙØ­Øµ: ÙŠØ¬Ø¨ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø«Ù„Ø§Ø« Ù…Ø±Ø§Øª Ù„Ø¥ØªÙ…Ø§Ù… Ø§Ù„ØªØ­Ù‚Ù‚.", 'critical', detailsHTML, (attemptCount / MAX_ATTEMPTS) * 100);
            document.getElementById('scanButton').disabled = false;
        }
        
        // --- (Ø¬Ø¯ÙŠØ¯) Ø¬Ù„Ø¨ Ù…ÙˆÙ‚Ø¹ IP ---
        async function getIPLocation() {
            try {
                // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø®Ø¯Ù…Ø© IP-API Ø§Ù„Ø¨Ø³ÙŠØ·Ø© Ù„ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ù…Ù† Ø¹Ù†ÙˆØ§Ù† IP
                const response = await fetch('https://ip-api.com/json/');
                const data = await response.json();
                
                if (data.status === 'success' && data.lat && data.lon) {
                    return {
                        lat: data.lat,
                        lon: data.lon,
                        city: data.city,
                        country: data.country
                    };
                } else {
                    console.error("IP API failed:", data.message || data.status);
                    return null;
                }
            } catch (error) {
                console.error("Error fetching IP location:", error);
                return null;
            }
        }


        // --- ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ÙƒØ´Ù ÙˆØ§Ù„Ù†ØªØ§Ø¦Ø¬ ---
        function checkResult(position) {
            const acc = position.coords.accuracy;
            const lat = position.coords.latitude;
            const lon = position.coords.longitude;
            const timestamp = position.timestamp;

            let checkMessage = `ğŸŸ¢ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© ${attemptCount}: ÙŠØ¨Ø¯Ùˆ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø·Ø¨ÙŠØ¹ÙŠØ§Ù‹.`;
            let checkClass = 'safe';
            let speedMessage = '--';
            let timeDiff = '--';
            let speedKmh = 0;
            let isSpoofingDetected = false;
            let distanceKm = 0;

            // 1. ÙØ­Øµ Ø§Ù„Ø³Ø±Ø¹Ø©
            if (lastPosition && attemptCount > 1) {
                timeDiff = (timestamp - lastPosition.timestamp) / 1000;
                const distKm = getDistance(lastPosition.coords.latitude, lastPosition.coords.longitude, lat, lon);
                speedKmh = distKm / (timeDiff / 3600); 

                if (speedKmh > SUSPICIOUS_SPEED_KMH && timeDiff > 1) {
                    checkMessage = `ğŸ”´ **ØªÙ†Ø¨ÙŠÙ‡ Ø­Ø§Ø³Ù… (ØªØ²ÙŠÙŠÙ GPS):** ØªÙ… Ø§Ù„ÙƒØ´Ù Ø¹Ù† Ø§Ù†ØªÙ‚Ø§Ù„ ØºÙŠØ± Ù…Ù†Ø·Ù‚ÙŠ (${speedKmh.toFixed(0)} ÙƒÙ…/Ø³Ø§Ø¹Ø©)!`;
                    checkClass = 'critical';
                    isSpoofingDetected = true;
                }
                speedMessage = `${speedKmh.toFixed(0)} ÙƒÙ…/Ø³Ø§Ø¹Ø©`;
            }

            // 2. ÙØ­Øµ Ø§Ù„Ø¯Ù‚Ø© (ØªØ²ÙŠÙŠÙ GPS)
            if (acc < PERFECT_ACCURACY_THRESHOLD) {
                checkMessage = `ğŸ”´ **ØªÙ†Ø¨ÙŠÙ‡ Ø­Ø§Ø³Ù… (ØªØ²ÙŠÙŠÙ GPS):** Ø¯Ù‚Ø© Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ù…Ø«Ø§Ù„ÙŠØ© Ø¨Ø´ÙƒÙ„ Ù…Ø±ÙŠØ¨ (${acc.toFixed(2)} Ù…ØªØ±).`;
                checkClass = 'critical';
                isSpoofingDetected = true;
            } else if (acc > FAIL_ACCURACY_THRESHOLD) {
                 checkMessage = `ğŸŸ¡ ÙØ´Ù„ ÙÙŠ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¨Ø¯Ù‚Ø©. (Ø§Ù„Ø¯Ù‚Ø©: ${(acc / 1000).toFixed(0)} ÙƒÙ…).`;
                 checkClass = 'suspicious';
            }
            
            // 3. (Ø¬Ø¯ÙŠØ¯) ÙØ­Øµ ØªÙ†Ø§Ù‚Ø¶ IP/GPS (ÙƒØ´Ù VPN)
            if (ipLocation && acc < FAIL_ACCURACY_THRESHOLD) { // Ù†ÙØ­Øµ VPN ÙÙ‚Ø· Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù‚Ø±Ø§Ø¡Ø© GPS Ù…Ø¹Ù‚ÙˆÙ„Ø©
                const gpsLat = lat;
                const gpsLon = lon;
                distanceKm = getDistance(gpsLat, gpsLon, ipLocation.lat, ipLocation.lon);

                if (distanceKm > VPN_DISCREPANCY_THRESHOLD_KM) {
                    checkMessage = `ğŸ”´ **ØªÙ†Ø¨ÙŠÙ‡ Ø­Ø§Ø³Ù… (VPN/Proxy):** Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…Ø³ØªÙ†Ø¯ Ø¥Ù„Ù‰ Ø§Ù„Ø´Ø¨ÙƒØ© (IP) ÙŠØ®ØªÙ„Ù Ø¹Ù† Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…Ø³ØªØ´Ø¹Ø±Ø§Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ Ø¨Ù€ ${distanceKm.toFixed(0)} ÙƒÙ….`;
                    checkClass = 'critical';
                    isSpoofingDetected = true;
                }
            }


            // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙØ§ØµÙŠÙ„
            const ipLat = ipLocation ? ipLocation.lat.toFixed(5) : '--';
            const ipLon = ipLocation ? ipLocation.lon.toFixed(5) : '--';

            const detailsHTML = `
                <p><strong>Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª (Ø§Ù„Ù…Ø³ØªØ´Ø¹Ø±Ø§Øª):</strong> ${lat.toFixed(5)}, ${lon.toFixed(5)}</p>
                <p><strong>Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª (Ø§Ù„Ø´Ø¨ÙƒØ© IP):</strong> ${ipLat}, ${ipLon}</p>
                <p><strong>Ø§Ù„Ø¯Ù‚Ø© Ø§Ù„Ù…ÙØ¨Ù„Ù‘Øº Ø¹Ù†Ù‡Ø§:</strong> ${acc.toFixed(2)} Ù…ØªØ±</p>
                <p><strong>Ù…ØµØ¯Ø± Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…ÙØ³ØªØ¯ÙÙ„:</strong> ${inferLocationSource(acc)}</p>
                <p><strong>Ø§Ù„Ø³Ø±Ø¹Ø© Ø§Ù„Ù…ÙÙ‚Ø¯Ù‘ÙØ±Ø©:</strong> ${speedMessage}</p>
                <p><strong>ØªÙ†Ø§Ù‚Ø¶ IP/GPS:</strong> ${distanceKm > 0 ? distanceKm.toFixed(0) + ' ÙƒÙ…' : '--'}</p>
            `;

            lastPosition = position;
            return { message: checkMessage, className: checkClass, detailsHTML: detailsHTML, isSpoofingDetected: isSpoofingDetected };
        }

        // --- Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙØ­Øµ Ø§Ù„Ù…ØªØ¹Ø¯Ø¯ (ØªÙ… ØªØ¹Ø¯ÙŠÙ„Ù‡Ø§ Ù„ØªÙƒÙˆÙ† ØºÙŠØ± Ù…ØªØ²Ø§Ù…Ù†Ø©) ---
        async function startMultiCheck() {
            document.getElementById('scanButton').disabled = true;
            attemptCount = 0;
            lastPosition = null;
            
            // 1. Ø¬Ù„Ø¨ Ù…ÙˆÙ‚Ø¹ IP Ø£ÙˆÙ„Ø§Ù‹
            updateScreen("Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ù†ÙˆØ§Ù† IP ÙˆÙ…ÙˆÙ‚Ø¹ Ø§Ù„Ø´Ø¨ÙƒØ©...", 'info', `<p><strong>Ø§Ù„Ø­Ø§Ù„Ø©:</strong> Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ Ù„Ù„Ø´Ø¨ÙƒØ©.</p>`, 5);
            ipLocation = await getIPLocation();

            if (!ipLocation) {
                updateScreen("ğŸ”´ ÙØ´Ù„ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† IP: ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø§ØªØµØ§Ù„Ùƒ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª.", 'critical', '<p><strong>Ø§Ù„Ø­Ø§Ù„Ø©:</strong> ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø®Ø¯Ù…Ø© Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ Ù„Ù„Ø´Ø¨ÙƒØ©.</p>', 100);
                document.getElementById('scanButton').disabled = false;
                return;
            }
            
            // 2. Ø§Ù„Ø¨Ø¯Ø¡ ÙÙŠ ÙØ­Øµ Ø§Ù„Ù…Ø³ØªØ´Ø¹Ø±Ø§Øª (GPS)
            runNextCheck(); 
        }

        function runNextCheck() {
            if (attemptCount >= MAX_ATTEMPTS) {
                document.getElementById('scanButton').disabled = false;
                return;
            }

            attemptCount++;
            const progress = (attemptCount / MAX_ATTEMPTS) * 100;
            const initialMessage = `Ø¬Ø§Ø±ÙŠ ÙØ­Øµ Ø§Ù„Ù…Ø³ØªØ´Ø¹Ø±Ø§Øª... (Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© ${attemptCount} Ù…Ù† ${MAX_ATTEMPTS})`;
            
            updateScreen(initialMessage, 'info', `<p><strong>Ø§Ù„Ø­Ø§Ù„Ø©:</strong> ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ø°Ù† Ø±Ù‚Ù… ${attemptCount} ÙÙŠ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©...</p>`, progress - (100/MAX_ATTEMPTS)/2);


            navigator.geolocation.getCurrentPosition(
                (position) => {
                    const result = checkResult(position);
                    
                    if (result.isSpoofingDetected) {
                        updateScreen(`ğŸ”´ Ù†ØªÙŠØ¬Ø© Ø§Ù„ÙØ­Øµ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©: ${result.message}`, 'critical', result.detailsHTML, 100);
                        document.getElementById('scanButton').disabled = false;
                        return;
                    }

                    updateScreen(result.message, result.className, result.detailsHTML, progress);

                    setTimeout(runNextCheck, SCAN_INTERVAL_MS);

                    if (attemptCount === MAX_ATTEMPTS) {
                        updateScreen("âœ… Ø§Ù„ÙØ­Øµ Ø§Ù„Ø´Ø§Ù…Ù„ Ø§ÙƒØªÙ…Ù„. Ø¬Ù‡Ø§Ø²Ùƒ Ø¢Ù…Ù† ÙˆÙ„Ø§ ÙŠÙˆØ¬Ø¯ ØªØ²ÙŠÙŠÙ GPS Ø£Ùˆ VPN.", 'safe', result.detailsHTML, 100);
                    }
                },
                handleError,
                { enableHighAccuracy: true, timeout: 7000, maximumAge: 0 }
            );
        }

    </script>
</body>
</html>